# 🔄 Auxly MCP Auto-Restart Feature

**Just like Todo2!** The Auxly MCP server now includes automatic restart on crash.

---

## ✨ **What's New?**

The Auxly MCP server now has:

- ✅ **Auto-restart on crash** - Server automatically restarts if it crashes
- ✅ **Exponential backoff** - Smart retry logic prevents restart loops
- ✅ **Process monitoring** - Tracks server health and restart count
- ✅ **Graceful shutdown** - Proper cleanup on termination
- ✅ **Detailed logging** - See restart events in real-time

---

## 📋 **Setup Instructions**

### Step 1: Build the MCP Server

```bash
cd C:\Auxly\mcp-server
npm run build
```

### Step 2: Update Cursor Settings

1. **Open Cursor Settings** (File → Preferences → Settings)
2. Search for **"MCP"** or go to **Extensions → MCP**
3. Click **"Edit in settings.json"**
4. Add this configuration:

```json
{
  "mcp": {
    "servers": {
      "auxly": {
        "command": "node",
        "args": [
          "C:\\Auxly\\mcp-server\\start-with-restart.js"
        ],
        "env": {
          "AUXLY_API_URL": "http://localhost:7000",
          "AUXLY_API_KEY": "your_api_key_here"
        }
      }
    }
  }
}
```

**⚠️ Important:** Replace `your_api_key_here` with your actual Auxly API key.

### Step 3: Restart Cursor

Close and reopen Cursor for changes to take effect.

### Step 4: Verify Auto-Restart

Open **Cursor → View → Output → MCP** to see logs:

```
📘 Starting Auxly MCP Server...
✅ Auxly MCP Server started (PID: 12345)
```

If the server crashes, you'll see:

```
❌ Server crashed with code 1
🔄 Auto-restart scheduled in 1000ms (attempt #1)
📘 Starting Auxly MCP Server...
✅ Auxly MCP Server started (PID: 12346)
```

---

## 🎯 **How It Works**

The `start-with-restart.js` wrapper:

1. **Monitors** the MCP server process
2. **Detects** crashes (non-zero exit codes)
3. **Waits** with exponential backoff (1s → 2s → 4s → 5s max)
4. **Restarts** automatically
5. **Resets** restart count after 10 seconds of stable operation

---

## 🧪 **Testing Auto-Restart**

To test if auto-restart works:

1. Find the Auxly MCP process:
   ```powershell
   Get-Process -Name node | Where-Object { $_.CommandLine -like "*auxly*" }
   ```

2. Kill it:
   ```powershell
   Stop-Process -Id <PID> -Force
   ```

3. Check Cursor's MCP logs - you should see the server restart automatically!

---

## 🔧 **Manual Start (for testing)**

You can also run the auto-restart wrapper manually:

```bash
cd C:\Auxly\mcp-server
node start-with-restart.js
```

This will show you real-time logs of restarts.

---

## 📊 **Comparison with Todo2**

| Feature | Todo2 MCP | Auxly MCP |
|---------|-----------|-----------|
| Auto-restart on crash | ✅ | ✅ |
| Process monitoring | ✅ | ✅ |
| Exponential backoff | ✅ | ✅ |
| Graceful shutdown | ✅ | ✅ |
| Restart logging | ✅ | ✅ |

**Now Auxly has the same reliability as Todo2!** 🎉

---

## 🚨 **Troubleshooting**

### Server not restarting?

1. Check Cursor's MCP logs for errors
2. Verify `dist/index.js` exists (run `npm run build`)
3. Ensure backend API is running on port 7000
4. Check API key is valid in Cursor settings

### Too many restarts?

If the server crashes repeatedly:

- **Check API connection:** Ensure `http://localhost:7000` is accessible
- **Check API key:** Verify your API key is valid
- **Check logs:** Look for error messages in Cursor's Output panel

---

## ✅ **Success Indicators**

You'll know auto-restart is working when:

- ✅ Auxly MCP tools appear in Cursor's autocomplete
- ✅ You can call `auxly_create_task` from AI chat
- ✅ Server restarts automatically after crashes
- ✅ MCP logs show restart events

---

## 📚 **Related Files**

- `start-with-restart.js` - Auto-restart wrapper script
- `cursor-config.json` - Example Cursor configuration
- `dist/index.js` - Compiled MCP server (generated by build)

---

**Made with ❤️ in Saudi Arabia 🇸🇦**


